(self.webpackChunkca_docs=self.webpackChunkca_docs||[]).push([[890],{6423:function(e,n,t){"use strict";t.r(n),t.d(n,{frontMatter:function(){return o},metadata:function(){return s},toc:function(){return p},default:function(){return c}});var a=t(2122),r=t(9756),i=(t(7294),t(3905)),l=t(2969),o={sidebar_position:1},s={unversionedId:"strategy/python",id:"strategy/python",isDocsHomePage:!1,title:"Python \u7b56\u7565\u958b\u767c",description:"Stable",source:"@site/i18n/zh-tw/docusaurus-plugin-content-docs/current/strategy/python.mdx",sourceDirName:"strategy",slug:"/strategy/python",permalink:"/public/docs/strategy/python",editUrl:"https://github.com/Crypto-Arsenal/public/edit/master/docs/strategy/python.mdx",version:"current",sidebarPosition:1,frontMatter:{sidebar_position:1},sidebar:"tutorialSidebar",previous:{title:"Get Started",permalink:"/public/docs/intro"},next:{title:"JavaScript \u7b56\u7565\u958b\u767c",permalink:"/public/docs/strategy/javascript"}},p=[{value:"\u57fa\u672c\u7d50\u69cb",id:"\u57fa\u672c\u7d50\u69cb",children:[]},{value:"\u7b56\u7565",id:"\u7b56\u7565",children:[]},{value:"\u67b6\u69cb",id:"\u67b6\u69cb",children:[{value:"Candles K \u7dda\u8cc7\u8a0a",id:"candles-k-\u7dda\u8cc7\u8a0a",children:[]},{value:"Exchange \u4ea4\u6613\u6240",id:"exchange-\u4ea4\u6613\u6240",children:[]},{value:"Pair \u4ea4\u6613\u5c0d",id:"pair-\u4ea4\u6613\u5c0d",children:[]},{value:"Assets \u8cc7\u7522",id:"assets-\u8cc7\u7522",children:[]},{value:"Orders \u8a02\u55ae",id:"orders-\u8a02\u55ae",children:[]},{value:"Order Books \u9650\u50f9\u8a02\u55ae\u7c3f",id:"order-books-\u9650\u50f9\u8a02\u55ae\u7c3f",children:[]}]},{value:"CA Strategy \u754c\u9762",id:"ca-strategy-\u754c\u9762",children:[{value:"<code>trade</code>",id:"trade",children:[]},{value:"<code>on_order_state_change</code>",id:"on_order_state_change",children:[]}]},{value:"CA \u7b56\u7565\u6a21\u7d44",id:"ca-\u7b56\u7565\u6a21\u7d44",children:[{value:"<code>CA.log</code>",id:"calog",children:[]},{value:"<code>CA.get_last_order_snapshot</code>",id:"caget_last_order_snapshot",children:[]},{value:"<code>CA.cancel_order</code>",id:"cacancel_order",children:[]},{value:"<code>CA.query_history_data</code>",id:"caquery_history_data",children:[]},{value:"<code>CA.storage</code>",id:"castorage",children:[]}]},{value:"\u9032\u968e\u6a21\u7d44",id:"\u9032\u968e\u6a21\u7d44",children:[{value:"<code>np</code>",id:"np",children:[]},{value:"<code>talib</code>",id:"talib",children:[]}]},{value:"\u5b58\u53d6\u7b56\u7565\u53c3\u6578",id:"\u5b58\u53d6\u7b56\u7565\u53c3\u6578",children:[{value:"\u7a7a\u55ae\u4ea4\u6613 <code>is_shorting</code>",id:"\u7a7a\u55ae\u4ea4\u6613-is_shorting",children:[]},{value:"\u624b\u7e8c\u8cbb <code>exchange_fee</code>",id:"\u624b\u7e8c\u8cbb-exchange_fee",children:[]},{value:"\u6ed1\u50f9\u8abf\u6574 <code>spread</code>",id:"\u6ed1\u50f9\u8abf\u6574-spread",children:[]},{value:"\u81ea\u5b9a\u7fa9\u53c3\u6578",id:"\u81ea\u5b9a\u7fa9\u53c3\u6578",children:[]}]},{value:"\u9ec3\u91d1\u4ea4\u53c9\u7b56\u7565\u7bc4\u4f8b",id:"\u9ec3\u91d1\u4ea4\u53c9\u7b56\u7565\u7bc4\u4f8b",children:[]},{value:"Binary Code",id:"binary-code",children:[]}],d={toc:p};function c(e){var n=e.components,t=(0,r.Z)(e,["components"]);return(0,i.kt)("wrapper",(0,a.Z)({},d,t,{components:n,mdxType:"MDXLayout"}),(0,i.kt)(l.y,{color:"#25c2a0",mdxType:"Highlight"}," Stable "),(0,i.kt)("h2",{id:"\u57fa\u672c\u7d50\u69cb"},"\u57fa\u672c\u7d50\u69cb"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"\u4f7f\u7528 ",(0,i.kt)("inlineCode",{parentName:"li"},"python 3")," \u64b0\u5beb ",(0,i.kt)("inlineCode",{parentName:"li"},"Strategy")," Class"),(0,i.kt)("li",{parentName:"ul"},"\u7cfb\u7d71\u900f\u904e\u56fa\u5b9a\u4ecb\u9762\u547c\u53eb\uff0c\u50b3\u5165\u5e02\u5834\u8cc7\u6599\uff0c\u7b56\u7565\u9808\u56de\u50b3\u662f\u5426\u57f7\u884c\u8a02\u55ae"),(0,i.kt)("li",{parentName:"ul"},"\u7b56\u7565\u9808\u81ea\u884c\u7dad\u8b77\u8a02\u55ae\u751f\u547d\u9031\u671f"),(0,i.kt)("li",{parentName:"ul"},"\u53ef\u4ee5\u4f7f\u7528 ",(0,i.kt)("a",{parentName:"li",href:"https://github.com/acrazing/talib-binding-node"},"TA-LIB")," \u8a08\u7b97\u5e38\u898b\u6280\u8853\u6307\u6a19\uff0c\u4f7f\u7528 TA \u5b58\u53d6"),(0,i.kt)("li",{parentName:"ul"},"\u53ef\u4ee5\u4f7f\u7528 ",(0,i.kt)("inlineCode",{parentName:"li"},"CA.log(str)")," \u7d00\u9304\u904b\u884c\u8cc7\u8a0a")),(0,i.kt)("h2",{id:"\u7b56\u7565"},"\u7b56\u7565"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-python"},"# Class name must be Strategy\nclass Strategy():\n    # option setting needed\n    def __setitem__(self, key, value):\n        self.options[key] = value\n\n    # option setting needed\n    def __getitem__(self, key):\n        return self.options.get(key, '')\n\n    def __init__(self):\n        # strategy property needed\n        self.subscribed_books = {\n            'Bitfinex': {\n                'pairs': ['ETH-USDT'],\n            },\n        }\n\n        # seconds for broker to call trade()\n        # do not set the frequency below 60 sec.\n        # 10 * 60 for 10 mins\n        self.period = 10 * 60\n        self.options = {}\n\n        # user defined class attribute\n        self.last_type = 'sell'\n\n\n    # called every self.period\n    def trade(self, information):\n        # for single pair strategy, user can choose which exchange/pair to use when launch, get current exchange/pair from information\n        exchange = list(information['candles'])[0]\n        pair = list(information['candles'][exchange])[0]\n        if self.last_type == 'sell':\n            self.last_type = 'buy'\n            return [\n                {\n                    'exchange': exchange,\n                    'amount': 1,\n                    'price': -1,\n                    'type': 'MARKET',\n                    'pair': pair,\n                },\n            ]\n        else:\n            self.last_type = 'sell'\n            return [\n                {\n                    'exchange': exchange,\n                    'amount': -1,\n                    'price': -1,\n                    'type': 'MARKET',\n                    'pair': pair,\n                },\n            ]\n        return []\n\n\n    def on_order_state_change(self, order):\n        CA.log(\"on order state change message: \" + str(order) + \" order price: \" + str(order[\"price\"]))\n\n")),(0,i.kt)("h2",{id:"\u67b6\u69cb"},"\u67b6\u69cb"),(0,i.kt)("h3",{id:"candles-k-\u7dda\u8cc7\u8a0a"},"Candles K \u7dda\u8cc7\u8a0a"),(0,i.kt)("p",null,"\u7cfb\u7d71\u547c\u53eb ",(0,i.kt)("inlineCode",{parentName:"p"},"strategy")," \u6642\uff0c\u6703\u50b3\u5165 ",(0,i.kt)("inlineCode",{parentName:"p"},"information")," \u7269\u4ef6\uff0c\u4ee5\u63d0\u4f9b 3 \u5927\u985e\u8cc7\u8a0a\uff1a ",(0,i.kt)("inlineCode",{parentName:"p"},"candles")," (K \u7dda\u8cc7\u8a0a), ",(0,i.kt)("inlineCode",{parentName:"p"},"orders")," (\u8a02\u55ae\uff09\uff0c\u4ee5\u53ca ",(0,i.kt)("inlineCode",{parentName:"p"}," orderBooks")," (\u9650\u50f9\u8a02\u55ae\u7c3f)\uff0e\u53d6\u7528\u65b9\u6cd5\u70ba:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-python"},"information['candles']\ninformation['orders']\ninformation['orderBooks']\n")),(0,i.kt)("div",{className:"admonition admonition-note alert alert--secondary"},(0,i.kt)("div",{parentName:"div",className:"admonition-heading"},(0,i.kt)("h5",{parentName:"div"},(0,i.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,i.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,i.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"}))),"note")),(0,i.kt)("div",{parentName:"div",className:"admonition-content"},(0,i.kt)("p",{parentName:"div"},"Candle \u6703\u4ee5 array of object \u7684\u5f62\u5f0f\u50b3\u5165\u4e0a\u6b21\u547c\u53eb\u5230\u6b64\u6b21\u547c\u53eb\u7684 K \u7dda\u5716\u8cc7\u8a0a\uff0c\u5171\u542b\u6709 6 \u9805\u8cc7\u8a0a open\u3001close\u3001high\u3001low\u3001volume \u548c time\uff0c\u53d6\u7528\u65b9\u5f0f\u5982\u4e0b:"))),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-python"},"information['candles'][exchange][pair][0]['open']\ninformation['candles'][exchange][pair][0]['close']\ninformation['candles'][exchange][pair][0]['high']\ninformation['candles'][exchange][pair][0]['low']\ninformation['candles'][exchange][pair][0]['volume']\ninformation['candles'][exchange][pair][0]['time']\n")),(0,i.kt)("h3",{id:"exchange-\u4ea4\u6613\u6240"},"Exchange \u4ea4\u6613\u6240"),(0,i.kt)("p",null,"\u7b56\u7565\u4f7f\u7528\u8005\u53ef\u65bc\u4f7f\u7528\u7b56\u7565\u6642\u6c7a\u5b9a\u4f7f\u7528\u7684 exchange \u4ea4\u6613\u6240 (\u4f8b\u5982 Bitfinex), \u9019\u6642\u6b64\u8a2d\u5b9a\u6703\u88ab\u5ffd\u7565\uff0c\u4ee5\u4f7f\u7528\u8005\u57f7\u884c\u7b56\u7565\u6642\u9078\u64c7\u70ba\u4e3b\uff0c\u7a0b\u5f0f\u5167\u8acb\u4f7f\u7528 information \u53d6\u5f97\u7576\u524d\u4f7f\u7528\u7684 exchange \u9032\u884c\u4ea4\u6613"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-python"},"exchange = list(information['candles'])[0]\n")),(0,i.kt)("h3",{id:"pair-\u4ea4\u6613\u5c0d"},"Pair \u4ea4\u6613\u5c0d"),(0,i.kt)("p",null,"Crypto-Arsenal \u652f\u63f4\u55ae\u4e00 Strategy \u540c\u6642\u8a3b\u518a\u591a\u7d44\u4ea4\u6613 ",(0,i.kt)("inlineCode",{parentName:"p"},"pair"),"\uff0c\u56e0\u6b64 ",(0,i.kt)("inlineCode",{parentName:"p"},"candle"),", ",(0,i.kt)("inlineCode",{parentName:"p"},"orders"),"\u8207 ",(0,i.kt)("inlineCode",{parentName:"p"},"orderBooks")," \u6703\u540c\u6642\u50b3\u5165\u591a\u7d44 pair \u7684\u8cc7\u8a0a\u3002\u7b56\u7565\u4f7f\u7528\u8005\u53ef\u65bc\u4f7f\u7528\u7b56\u7565\u6642\u6307\u5b9a\u4f7f\u7528\u7684 ",(0,i.kt)("inlineCode",{parentName:"p"},"pair")," (\u4f8b\u5982 BTC-USDT)\uff0c\u9019\u6642\u7a0b\u5f0f\u5167\u8a2d\u5b9a\u7684 ",(0,i.kt)("inlineCode",{parentName:"p"},"pair")," \u6703\u4f7f\u7528\u57f7\u884c\u7b56\u7565\u6642\u6307\u5b9a\u7684\u4ea4\u6613\u5c0d\u3002\u7b56\u7565\u5167\u53ef\u4f7f\u7528 ",(0,i.kt)("inlineCode",{parentName:"p"},"information")," \u53d6\u5f97\u7576\u524d\u4f7f\u7528\u7684 ",(0,i.kt)("inlineCode",{parentName:"p"},"pair")," \u9032\u884c\u4ea4\u6613"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-python"},"pair = list(information['candles'][exchange])[0]\n")),(0,i.kt)("h3",{id:"assets-\u8cc7\u7522"},"Assets \u8cc7\u7522"),(0,i.kt)("p",null,"\u7b56\u7565\u64c1\u6709\u96a8\u6642\u66f4\u65b0\u7684 ",(0,i.kt)("inlineCode",{parentName:"p"},"assets")," \u8cc7\u7522\u8cc7\u8a0a\uff0c\u5373\u7576\u524d\u53ef\u9032\u884c\u64cd\u4f5c\u7684\u8ca8\u5e63\uff0c\u53d6\u7528\u65b9\u5f0f\u5982\u4e0b:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-python"},"  pair = list(information['candles'][exchange])[0] #BTC-USDT\n  target_currency = pair.split('-')[0]  #BTC\n  base_currency = pair.split('-')[1]  #USDT\n  # \u53d6\u5f97\u7576\u4e0b\u64c1\u6709\u7684\u8ca8\u5e63\u6578\u91cf\n  base_currency_amount = self['assets'][exchange][base_currency]\n  target_currency_amount = self['assets'][exchange][target_currency]\n")),(0,i.kt)("h3",{id:"orders-\u8a02\u55ae"},"Orders \u8a02\u55ae"),(0,i.kt)("p",null,"\u4f7f\u7528 ",(0,i.kt)("inlineCode",{parentName:"p"},"information['orders']")," \u53d6\u5f97\u8a02\u55ae\u8cc7\u8a0a\uff0c\u4ee5 list of dirctionary \u7684\u5f62\u5f0f\u5132\u5b58\uff0c\u7b2c\u4e00\u7b46\u8a02\u55ae\u70ba ",(0,i.kt)("inlineCode",{parentName:"p"},"information['orders'][0]"),"\uff0c\u8a02\u55ae\u5167\u5305\u542b\u7684\u8cc7\u6599\u6709\uff1a ",(0,i.kt)("inlineCode",{parentName:"p"},"price"),", ",(0,i.kt)("inlineCode",{parentName:"p"},"amount"),", ",(0,i.kt)("inlineCode",{parentName:"p"},"status")," \u548c",(0,i.kt)("inlineCode",{parentName:"p"},"orderId"),"\uff0c\u5176\u4e2d status \u53ef\u80fd\u70ba",(0,i.kt)("inlineCode",{parentName:"p"},"FILLED")," \u6216 ",(0,i.kt)("inlineCode",{parentName:"p"},"NEW"),"\uff0c\u5206\u5225\u4ee3\u8868\u6210\u4ea4\u6216\u5c1a\u672a\u6210\u4ea4\u3002\u53d6\u7528\u7bc4\u4f8b\u5982\u4e0b:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-python"},"  for i in range(len(information['orders'])):\n    Log('order price: ' + str(information['orders'][i]['price']) +\n    ' ,order amount: ' + str(information['orders'][i]['amount']) +\n    ' ,status: ' + str(information['orders'][i]['status']) +\n    ' ,orderId: ' + str(information['orders'][i]['orderId']))\n\n")),(0,i.kt)("h3",{id:"order-books-\u9650\u50f9\u8a02\u55ae\u7c3f"},"Order Books \u9650\u50f9\u8a02\u55ae\u7c3f"),(0,i.kt)("p",null,"Order Books \u662f\u5728\u5be6\u969b\u4ea4\u6613\u6642\u624d\u6703\u4f7f\u7528\uff0c\u4ee5\u89c0\u5bdf\u7576\u4e0b\u5e02\u5834\u9650\u50f9\u55ae\u7684\u50f9\u683c\u8207\u6578\u91cf\uff0c\u5728\u56de\u6e2c\u548c\u7af6\u6280\u5834\u6bd4\u8cfd\u90fd\u4e0d\u6703\u7528\u5230\u3002(\u5728\u57f7\u884c Backtest \u6a21\u5f0f\u4e2d\uff0c\u4e0d\u6703\u50b3\u5165 Order Books \u8cc7\u8a0a\u3002)\n\u4f7f\u7528 Order Books \u53ef\u53d6\u5f97\u6307\u5b9a\u4ea4\u6613\u6240\u4e2d\u6307\u5b9a\u4ea4\u6613\u5c0d\u7684\u8a02\u55ae\u7c3f\u8cc7\u8a0a\uff0c\u5206\u70ba ",(0,i.kt)("inlineCode",{parentName:"p"},"asks")," \u8cb7\u50f9\u8207 ",(0,i.kt)("inlineCode",{parentName:"p"},"bids")," \u8ce3\u50f9\u5169\u5927\u985e\uff0c\u53ef\u53d6\u5f97\u7576\u4e0b\u8a02\u55ae\u7c3f\u7684 ",(0,i.kt)("inlineCode",{parentName:"p"},"price")," \u50f9\u683c, ",(0,i.kt)("inlineCode",{parentName:"p"},"count")," \u8a02\u55ae\u6578\u91cf\u548c ",(0,i.kt)("inlineCode",{parentName:"p"},"amount")," \u5e63\u6578\u91cf\uff0c\u53d6\u7528\u65b9\u5f0f\u5982\u4e0b:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-python"},"  order_books = information['orderBooks']\n  one_order_book = order_books[exchange][pair]\n\n  ask_order_book = one_order_book['asks']\n  last_ask_price = ask_order_book[-1]['price']\n  last_ask_count = ask_order_book[-1]['count']\n  last_ask_amount = ask_order_book[-1]['amount']\n\n  bid_order_book = one_order_book['bids']\n  last_bid_price = bid_order_book[-1]['price']\n  last_bid_count = bid_order_book[-1]['count']\n  last_bid_amount = bid_order_book[-1]['amount']\n\n")),(0,i.kt)("h2",{id:"ca-strategy-\u754c\u9762"},"CA Strategy \u754c\u9762"),(0,i.kt)("div",{className:"admonition admonition-caution alert alert--warning"},(0,i.kt)("div",{parentName:"div",className:"admonition-heading"},(0,i.kt)("h5",{parentName:"div"},(0,i.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,i.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16"},(0,i.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"}))),"caution")),(0,i.kt)("div",{parentName:"div",className:"admonition-content"},(0,i.kt)("p",{parentName:"div"},(0,i.kt)("inlineCode",{parentName:"p"},"Strategy")," class \u7b56\u7565\u5fc5\u9808\u6709\u4ee5\u4e0b methods"))),(0,i.kt)("h3",{id:"trade"},(0,i.kt)("inlineCode",{parentName:"h3"},"trade")),(0,i.kt)("p",null,"\u5728 Crypto-Arsenal \u7684\u7b56\u7565\u4e2d\uff0c\u8981\u5411\u4ea4\u6613\u6240\u4e0b\u8a02\u55ae\u7684\u65b9\u5f0f\u63a1\u7528\u7cfb\u7d71\u547c\u53eb",(0,i.kt)("inlineCode",{parentName:"p"},"trade"),"\u7684\u56de\u50b3\u503c\u9032\u884c\u4ea4\u6613\u3002"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-python"},"def trade(self, information):\n    [\n        {\n        'exchange': string\n        'pair': string\n        'type': string\n        'amount': float\n        'price': float\n        }\n    ]\n")),(0,i.kt)("h4",{id:"\u6b04\u4f4d\u8aaa\u660e"},"\u6b04\u4f4d\u8aaa\u660e"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"exchange: \u6b64\u7b46\u8a02\u55ae\u8981\u5411\u54ea\u500b\u4ea4\u6613\u6240\u9032\u884c\u4ea4\u6613"),(0,i.kt)("li",{parentName:"ul"},"pair: \u4ea4\u6613\u8ca8\u5e63\u5c0d"),(0,i.kt)("li",{parentName:"ul"},"type: \u6b64\u7b46\u8a02\u55ae\u63a1\u7528\u4f55\u7a2e\u4ea4\u6613\u65b9\u5f0f (\u9650\u50f9: ",(0,i.kt)("inlineCode",{parentName:"li"},"LIMIT")," \u5e02\u50f9: ",(0,i.kt)("inlineCode",{parentName:"li"},"MARKET"),")"),(0,i.kt)("li",{parentName:"ul"},"amount: \u8981\u4ea4\u6613\u7684\u6578\u4f4d\u8ca8\u5e63\u6578\u91cf\uff0c\u5927\u65bc 0 \u4ee3\u8868\u8cfc\u8cb7\uff0c\u5c0f\u65bc 0 \u4ee3\u8868\u8ca9\u8ce3"),(0,i.kt)("li",{parentName:"ul"},"price: \u4ee5\u591a\u5c11\u50f9\u683c\u9032\u884c\u4ea4\u6613\uff0c\u82e5\u63a1\u7528\u5e02\u50f9\uff0c\u6b64\u6b04\u4f4d\u53ef\u4efb\u610f\u586b\u503c")),(0,i.kt)("h4",{id:"\u9650\u50f9\u7bc4\u4f8b"},"\u9650\u50f9\u7bc4\u4f8b"),(0,i.kt)("p",null,"\u6b64\u8a02\u55ae\u70ba\u6b32\u5411",(0,i.kt)("inlineCode",{parentName:"p"},"Binance"),"\u4ea4\u6613\u6240\uff0c\u4ee5\u6bcf\u55ae\u4f4d",(0,i.kt)("inlineCode",{parentName:"p"},"212.42"),"\u8cfc\u8cb7",(0,i.kt)("inlineCode",{parentName:"p"},"1"),"\u500b",(0,i.kt)("inlineCode",{parentName:"p"},"ETH-USDT"),"\u7684\u4ea4\u6613\u914d\u5c0d"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-python"},"[\n  {\n    'exchange': 'Binance',\n    'pair': 'ETH-USDT',\n    'type': 'LIMIT',\n    'amount': 1,\n    'price': 212.42\n  }\n]\n")),(0,i.kt)("h4",{id:"\u5e02\u50f9\u7bc4\u4f8b"},"\u5e02\u50f9\u7bc4\u4f8b"),(0,i.kt)("p",null,"\u6b64\u8a02\u55ae\u70ba\u6b32\u5411",(0,i.kt)("inlineCode",{parentName:"p"},"Binance"),"\u4ea4\u6613\u6240\uff0c\u4ee5",(0,i.kt)("inlineCode",{parentName:"p"},"\u5e02\u50f9"),"\u8cfc\u8cb7",(0,i.kt)("inlineCode",{parentName:"p"},"1"),"\u500b",(0,i.kt)("inlineCode",{parentName:"p"},"ETH-USDT"),"\u7684\u4ea4\u6613\u914d\u5c0d"),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"\u96d6\u7136\u4ea4\u6613\u63a1\u7528\u5e02\u50f9\uff0cprice \u4ecd\u9808\u5b58\u5728\uff0c\u503c\u70ba\u96a8\u610f\u6578\u503c")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-python"},"[\n  {\n    'exchange': 'Binance',\n    'pair': 'ETH-USDT',\n    'type': 'MARKET',\n    'amount': 1,\n    'price': -1\n  }\n]\n")),(0,i.kt)("h3",{id:"on_order_state_change"},(0,i.kt)("inlineCode",{parentName:"h3"},"on_order_state_change")),(0,i.kt)("p",null,"\u56de\u50b3\u6bcf\u4e00\u7b46\u8a02\u55ae\u7d00\u9304\uff0c\u7d50\u69cb\u5982\u4e0b"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-python"},"{\n    'exchange': 'Bitfinex',\n    'pair': 'ETH-USDT',\n    'amount': 1.0,\n    'amountFilled': 1.0,\n    'price': 1849.7,\n    'type': 'MARKET',\n    'status': 'FILLED'\n}\n")),(0,i.kt)("h4",{id:"\u7bc4\u4f8b"},"\u7bc4\u4f8b"),(0,i.kt)("p",null,"\u7b56\u7565\u5167\u9700 ",(0,i.kt)("inlineCode",{parentName:"p"},"define")," \u4e00\u500b\u51fd\u6578 ",(0,i.kt)("inlineCode",{parentName:"p"},"on_order_state_change"),"\uff0c\u5e73\u53f0\u6703\u4f9d\u7167\u4f7f\u7528\u8005\u5b9a\u7fa9\u4e4b\u9031\u671f\u547c\u53eb\u6b64\u51fd\u6578\uff0c\u4ee5\u53d6\u56de\u8a02\u55ae\u8cc7\u8a0a\u4e26\u5370\u51fa\u76f8\u95dc\u8cc7\u8a0a\u3002"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-python"},'def on_order_state_change(self,  order):\n    CA.log("on order state change message: " + str(order) + " order price: " + str(order["price"]))\n')),(0,i.kt)("h2",{id:"ca-\u7b56\u7565\u6a21\u7d44"},"CA \u7b56\u7565\u6a21\u7d44"),(0,i.kt)("h3",{id:"calog"},(0,i.kt)("inlineCode",{parentName:"h3"},"CA.log")),(0,i.kt)("p",null,"\u7528\u4f86\u5370\u51fa\u6307\u5b9a\u8a0a\u606f\uff0c\u53ef\u5370\u6700\u5927\u9577\u5ea6\u70ba 200 \u500b\u5b57\u4e32"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-python"},"CA.log(str);\n")),(0,i.kt)("h4",{id:"\u7bc4\u4f8b-1"},"\u7bc4\u4f8b"),(0,i.kt)("p",null,"\u5370\u51fa\u6536\u76e4\u50f9\u3001\u958b\u76e4\u50f9\u8207\u4ea4\u6613\u91cf"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-python"},"exchange = list(information['candles'])[0] //Bitfinex\npair = list(information['candles'][exchange])[0] //BTC-USDT\nCA.log(information['candles'][exchange][pair][0]['close'])\nCA.log(information['candles'][exchange][pair][0]['open'])\nCA.log(information['candles'][exchange][pair][0]['volume'])\n")),(0,i.kt)("h4",{id:"\u7bc4\u4f8b-2"},"\u7bc4\u4f8b"),(0,i.kt)("p",null,"\u5370\u51fa\u64c1\u6709\u7684\u8cc7\u7522'USDT'\u548c'BTC'"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-python"},"CA.log('assest usdt: ' + str(self['assets'][exchange]['USDT']))\nCA.log('assest btc: ' + str(self['assets'][exchange]['BTC']))\n")),(0,i.kt)("h3",{id:"caget_last_order_snapshot"},(0,i.kt)("inlineCode",{parentName:"h3"},"CA.get_last_order_snapshot")),(0,i.kt)("p",null,"\u56de\u50b3\u6700\u5f8c\u4e00\u6b21\u6210\u4ea4\u7684\u8a02\u55ae\u8cc7\u8a0a\uff0c\u4f7f\u7528 ",(0,i.kt)("inlineCode",{parentName:"p"},"dictionary")," \u7d00\u9304\u6210\u4ea4\u8a02\u55ae\u8cc7\u8a0a"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-python"},"  exchange: string;\n  pair: string;\n  orderId: number;\n  amount: number;\n  amountFilled: number;\n  price: number;\n  type: string;\n  status: string;\n  margin: boolean;\n")),(0,i.kt)("h4",{id:"\u7bc4\u4f8b-3"},"\u7bc4\u4f8b"),(0,i.kt)("p",null,"\u53d6\u56de\u6700\u5f8c\u4e00\u6b21\u6210\u4ea4\u7d00\u9304\uff0c\u4e26\u5370\u51fa\u50f9\u91cf\u8cc7\u8a0a\u3002\u8207 ",(0,i.kt)("inlineCode",{parentName:"p"},"on_order_state_change")," \u4e0d\u540c\uff0c",(0,i.kt)("inlineCode",{parentName:"p"},"CA.get_last_order_snapshot")," \u51fd\u6578\u662f\u5728 ",(0,i.kt)("inlineCode",{parentName:"p"},"trade")," \u51fd\u6578\u7576\u4e2d\u547c\u53eb\u3002"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-python"},"snap = CA.get_last_order_snapshot()\nif snap != {}:\n    CA.log( 'snap_amount: ' + str(snap['amount']) + ' ,snap_price: ' + str(snap['price']))\n\n")),(0,i.kt)("h3",{id:"cacancel_order"},(0,i.kt)("inlineCode",{parentName:"h3"},"CA.cancel_order")),(0,i.kt)("p",null,"\u522a\u9664\u8a02\u55ae\u53ef\u4f7f\u7528 ",(0,i.kt)("inlineCode",{parentName:"p"},"CA.cancel_order")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"  exchange: string;\n  pair: string;\n  orderId: number\n")),(0,i.kt)("h4",{id:"\u7bc4\u4f8b-4"},"\u7bc4\u4f8b"),(0,i.kt)("p",null,"\u4ee5\u4e0b\u7bc4\u4f8b\u70ba\u522a\u9664\u7b2c\u4e00\u7b46\u639b\u4e0a\u7684\u8a02\u55ae:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-python"},"  CA.cancel_order({\n    exchange: 'binance',\n    pair: 'BTC-USDT',\n    orderId: information['orders'][0]\n  })\n")),(0,i.kt)("h3",{id:"caquery_history_data"},(0,i.kt)("inlineCode",{parentName:"h3"},"CA.query_history_data")),(0,i.kt)("p",null,"\u53ef\u5728 ",(0,i.kt)("inlineCode",{parentName:"p"},"__init__")," \u51fd\u6578\u4e2d\u53d6\u5f97\u904e\u53bb\u4e00\u6bb5\u6642\u9593\u7684\u6b77\u53f2\u8cc7\u6599\uff0c\u4ee5\u4fbf\u57f7\u884c\u7b56\u7565\u7576\u4e0b\u5373\u53ef\u8a08\u7b97\u76f8\u95dc\u53c3\u6578\uff08\u4f8b\u5982 MA\uff09\u3002\nCA.query_history_data(length, period) \u53ef\u53d6\u5f97\u904e\u53bb\u5e7e\u500b ",(0,i.kt)("inlineCode",{parentName:"p"},"length")," \u9031\u671f ",(0,i.kt)("inlineCode",{parentName:"p"},"period")," \u7684\u8cc7\u6599\u3002"),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Input")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"  length: number;\n  period: number;\n")),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Output")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"  error: string;\n  candles: JSON;\n")),(0,i.kt)("h4",{id:"\u7bc4\u4f8b-5"},"\u7bc4\u4f8b"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-python"},"def __init__(self):\n\n    self.subscribed_books = {\n        'Binance': {\n            'pairs': ['BTC-USDT'],\n        },\n    }\n    self.period = 60 * 60  # 1 hour\n\n    # query the past 7 days data\n    self.history_data = CA.query_history_data(168, self.period)\n\n    if self.history_data:\n        exchange = list(self.history_data['candles'])[0]\n        pair = list(self.history_data['candles'][exchange])[0]\n        high_list = np.array([])\n        for candles in self.history_data['candles'][exchange][pair]:\n            CA.log('history high: ' + str(candles['high']))\n\n")),(0,i.kt)("h3",{id:"castorage"},(0,i.kt)("inlineCode",{parentName:"h3"},"CA.storage")),(0,i.kt)(l.y,{color:"#ffba00",mdxType:"Highlight"}," In Progress "),(0,i.kt)("p",null,"\u5b58\u53d6\u9375\u503c\u5c0d \u53ef\u5728\u7b56\u7565\u7d50\u675f\u5f8c\u8b80\u53d6"),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Input")),(0,i.kt)("p",null,"To set key value"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"  key: string;\n  value: any;\n")),(0,i.kt)("p",null,"To access key"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"  key: string;\n")),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Output")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"  value: string;\n")),(0,i.kt)("h4",{id:"\u7bc4\u4f8b-6"},"\u7bc4\u4f8b"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-python"},"CA.storage('string', 'to the moon \ud83c\udf19')\nval = CA.storage('string') # to the moon \ud83c\udf19\n\nCA.storage('int', 131441)\nval = CA.storage('int') # 131441\n\nCA.storage('none', None)\nval = CA.storage('none') # None\n")),(0,i.kt)("h2",{id:"\u9032\u968e\u6a21\u7d44"},"\u9032\u968e\u6a21\u7d44"),(0,i.kt)("h3",{id:"np"},(0,i.kt)("inlineCode",{parentName:"h3"},"np")),(0,i.kt)("p",null,"\u53ef\u4f7f\u7528 np \u5b58\u53d6 ",(0,i.kt)("a",{parentName:"p",href:"http://www.numpy.org/"},"numpy")),(0,i.kt)("h3",{id:"talib"},(0,i.kt)("inlineCode",{parentName:"h3"},"talib")),(0,i.kt)("p",null,"\u53ef\u4f7f\u7528 talib \u5b58\u53d6 ",(0,i.kt)("a",{parentName:"p",href:"https://github.com/mrjbq7/ta-lib"},"talib")),(0,i.kt)("h4",{id:"\u7bc4\u4f8b-7"},"\u7bc4\u4f8b"),(0,i.kt)("p",null,"\u4f7f\u7528 np.append\uff0c\u4f7f\u7528 talib \u8a08\u7b97 RSI"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-python"},"self.close_price_trace = np.append(self.close_price_trace, [float( information['candles'][exchange][pair][0]['close'])])\nrsi = talib.RSI(self.close_price_trace, Len)[-1]\n")),(0,i.kt)("h2",{id:"\u5b58\u53d6\u7b56\u7565\u53c3\u6578"},"\u5b58\u53d6\u7b56\u7565\u53c3\u6578"),(0,i.kt)("div",{className:"admonition admonition-info alert alert--info"},(0,i.kt)("div",{parentName:"div",className:"admonition-heading"},(0,i.kt)("h5",{parentName:"div"},(0,i.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,i.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,i.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"}))),"info")),(0,i.kt)("div",{parentName:"div",className:"admonition-content"},(0,i.kt)("p",{parentName:"div"},"\u7cfb\u7d71\u9810\u7559\u53c3\u6578"))),(0,i.kt)("h3",{id:"\u7a7a\u55ae\u4ea4\u6613-is_shorting"},"\u7a7a\u55ae\u4ea4\u6613 ",(0,i.kt)("inlineCode",{parentName:"h3"},"is_shorting")),(0,i.kt)("p",null,"\u4f7f\u7528\u8005\u900f\u904e\u5c07 is_shorting \u53c3\u6578\u8a2d\u5b9a\u70ba true\uff0c\u53ef\u958b\u555f\u7a7a\u55ae\u4ea4\u6613\u6a21\u5f0f"),(0,i.kt)("h3",{id:"\u624b\u7e8c\u8cbb-exchange_fee"},"\u624b\u7e8c\u8cbb ",(0,i.kt)("inlineCode",{parentName:"h3"},"exchange_fee")),(0,i.kt)("p",null,"\u53e6\u53ef\u8abf\u6574 exchange_fee \u4ee5\u53ca spread\uff0c\u4ee5\u8a2d\u5b9a\u66f4\u56b4\u683c\u7684\u56de\u6e2c\u689d\u4ef6\n",(0,i.kt)("img",{parentName:"p",src:"https://drive.google.com/uc?export=view&id=1IWJoekgYPgQWfxfLv_DZ3KjtTkuIeA4L",alt:"image2"}),"\n\u4e0a\u5716\u6240\u793a\uff0cexchange_fee \u8a2d\u5b9a\u70ba 0.01\uff0c\u4ee3\u8868\u6bcf\u4e00\u7b46\u4ea4\u6613\u6703\u52a0\u6536\u7e3d\u984d 1%\u8cbb\u7528\n\uff08\u82e5\u6c92\u6709\u8a2d\u5b9a\uff0c\u9810\u8a2d\u662f 0.1%\u7684\u624b\u7e8c\u8cbb\uff09"),(0,i.kt)("h3",{id:"\u6ed1\u50f9\u8abf\u6574-spread"},"\u6ed1\u50f9\u8abf\u6574 ",(0,i.kt)("inlineCode",{parentName:"h3"},"spread")),(0,i.kt)("p",null,"spread \u4ee3\u8868\u6ed1\u9ede\uff0c0.05 \u4ee3\u8868\u6bcf\u7b46\u4ea4\u6613\u50f9\u683c\u6703\u6709 5%\u5dee\u7570"),(0,i.kt)("h3",{id:"\u81ea\u5b9a\u7fa9\u53c3\u6578"},"\u81ea\u5b9a\u7fa9\u53c3\u6578"),(0,i.kt)("p",null,"\u900f\u904e ",(0,i.kt)("inlineCode",{parentName:"p"},"self['OPTION_NAME']")," \u5b58\u53d6\u7b56\u7565\u53c3\u6578"),(0,i.kt)("p",null,"You can add some extra arguments for the strategy and change these arguments for every live trade, backtest or simulation.\nFor example, if you have the following configuration for a strategy"),(0,i.kt)("div",{className:"admonition admonition-caution alert alert--warning"},(0,i.kt)("div",{parentName:"div",className:"admonition-heading"},(0,i.kt)("h5",{parentName:"div"},(0,i.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,i.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16"},(0,i.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"}))),"caution")),(0,i.kt)("div",{parentName:"div",className:"admonition-content"},(0,i.kt)("p",{parentName:"div"},"All arguments are actually stored and parsed as ",(0,i.kt)("inlineCode",{parentName:"p"},"String")," type in your strategy code. ",(0,i.kt)("strong",{parentName:"p"},"So you have to parse it by your self!")))),(0,i.kt)("h4",{id:"type"},"Type"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"Boolean"),(0,i.kt)("p",{parentName:"li"},"A ",(0,i.kt)("strong",{parentName:"p"},"STRING")," that indicates either ",(0,i.kt)("inlineCode",{parentName:"p"},"true")," or ",(0,i.kt)("inlineCode",{parentName:"p"},"false"))),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"Number"),(0,i.kt)("p",{parentName:"li"},"A ",(0,i.kt)("strong",{parentName:"p"},"STRING")," that represents a ",(0,i.kt)("inlineCode",{parentName:"p"},"float")," value.")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"String"),(0,i.kt)("p",{parentName:"li"},"A ",(0,i.kt)("strong",{parentName:"p"},"STRING")," that holds a ",(0,i.kt)("inlineCode",{parentName:"p"},"ASCII")," string")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"Select"),(0,i.kt)("p",{parentName:"li"},"A ",(0,i.kt)("strong",{parentName:"p"},"STRING")," that holds a list of ",(0,i.kt)("inlineCode",{parentName:"p"},"ASCII")," string. Separated by the symbol vertical bar ",(0,i.kt)("inlineCode",{parentName:"p"},"|"),"."))),(0,i.kt)("h4",{id:"example"},"Example"),(0,i.kt)("p",null,"Suppose you use the following configuration"),(0,i.kt)("table",null,(0,i.kt)("thead",{parentName:"table"},(0,i.kt)("tr",{parentName:"thead"},(0,i.kt)("th",{parentName:"tr",align:null},"Variable"),(0,i.kt)("th",{parentName:"tr",align:null},"Description"),(0,i.kt)("th",{parentName:"tr",align:null},"Type"),(0,i.kt)("th",{parentName:"tr",align:null},"Default Value"))),(0,i.kt)("tbody",{parentName:"table"},(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"MyArgA"),(0,i.kt)("td",{parentName:"tr",align:null},"true/false"),(0,i.kt)("td",{parentName:"tr",align:null},"Boolean"),(0,i.kt)("td",{parentName:"tr",align:null},"true")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"MyArgB"),(0,i.kt)("td",{parentName:"tr",align:null},"a float num"),(0,i.kt)("td",{parentName:"tr",align:null},"Number"),(0,i.kt)("td",{parentName:"tr",align:null},"10.9")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"MyArgC"),(0,i.kt)("td",{parentName:"tr",align:null},"a ASCII Str"),(0,i.kt)("td",{parentName:"tr",align:null},"String"),(0,i.kt)("td",{parentName:"tr",align:null},"Hello World!")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"MyArgD"),(0,i.kt)("td",{parentName:"tr",align:null},"a ASCII list"),(0,i.kt)("td",{parentName:"tr",align:null},"Select"),(0,i.kt)("td",{parentName:"tr",align:null},"OptionA","|","OptionB","|","OptionC")))),(0,i.kt)("div",{className:"admonition admonition-note alert alert--secondary"},(0,i.kt)("div",{parentName:"div",className:"admonition-heading"},(0,i.kt)("h5",{parentName:"div"},(0,i.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,i.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,i.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"}))),"note")),(0,i.kt)("div",{parentName:"div",className:"admonition-content"},(0,i.kt)("p",{parentName:"div"},"Only ASCII string is supported currently"))),(0,i.kt)("p",null,"Then you're allowed to tweak these variables to be used in your strategy before trading. ",(0,i.kt)("inlineCode",{parentName:"p"},"MyArgD")," will appear as a list consisting of ",(0,i.kt)("inlineCode",{parentName:"p"},"OptionA"),", ",(0,i.kt)("inlineCode",{parentName:"p"},"OptionB")," and ",(0,i.kt)("inlineCode",{parentName:"p"},"OptionC"),"."),(0,i.kt)("p",null,(0,i.kt)("img",{parentName:"p",src:"https://user-images.githubusercontent.com/5862369/56237500-b3511900-60be-11e9-878d-3e5c2cff4991.png",alt:"image"})),(0,i.kt)("h4",{id:"\u7bc4\u4f8b-8"},"\u7bc4\u4f8b"),(0,i.kt)("p",null,"\u7576\u4f7f\u7528\u8005\u81ea\u5b9a\u7fa9\u53c3\u6578 R1\uff0c\u4f7f\u7528\u4ee5\u4e0b\u65b9\u6cd5\u53ef\u5728\u7a0b\u5f0f\u5167\u53d6\u56de\u6240\u5b9a\u7fa9\u7684 R1 \u6578\u503c\n",(0,i.kt)("img",{parentName:"p",src:"https://drive.google.com/uc?export=view&id=16-bHa0jOZvPerOqEdIKRwDXlH50MHplr",alt:"image"})),(0,i.kt)("div",{className:"admonition admonition-note alert alert--secondary"},(0,i.kt)("div",{parentName:"div",className:"admonition-heading"},(0,i.kt)("h5",{parentName:"div"},(0,i.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,i.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,i.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"}))),"note")),(0,i.kt)("div",{parentName:"div",className:"admonition-content"},(0,i.kt)("p",{parentName:"div"},"You can access these arguments by ",(0,i.kt)("inlineCode",{parentName:"p"},"self['argName']")))),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-python"},"def trade(self, information):\n    R1 = float(self['R1'])\n\nCA.log(self['MyArgA']) # true\nCA.log(str(self['MyArgA'].__class__)) # <class 'str'>\n\nCA.log(self['MyArgB']) # 10.9\nCA.log(str(self['MyArgB'].__class__)) # <class 'str'>\n\nCA.log(self['MyArgC']) # Hello World!\nCA.log(str(self['MyArgC'].__class__)) # <class 'str'>\n\nCA.log(self['MyArgD']) # OptionC\nCA.log(str(self['MyArgD'].__class__)) # <class 'str'>\n")),(0,i.kt)("div",{className:"admonition admonition-caution alert alert--warning"},(0,i.kt)("div",{parentName:"div",className:"admonition-heading"},(0,i.kt)("h5",{parentName:"div"},(0,i.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,i.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16"},(0,i.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"}))),"All of the types are string in python")),(0,i.kt)("div",{parentName:"div",className:"admonition-content"},(0,i.kt)("p",{parentName:"div"},"So if you want to check MyArgA is true or not, you have to use it like ",(0,i.kt)("inlineCode",{parentName:"p"},"if self['MyArgA'] == 'true'")," instead of ",(0,i.kt)("del",{parentName:"p"},(0,i.kt)("inlineCode",{parentName:"del"},"if self['MyArgA]")),"."))),(0,i.kt)("h2",{id:"\u9ec3\u91d1\u4ea4\u53c9\u7b56\u7565\u7bc4\u4f8b"},"\u9ec3\u91d1\u4ea4\u53c9\u7b56\u7565\u7bc4\u4f8b"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-python"},"class Strategy():\n    # option setting needed\n    def __setitem__(self, key, value):\n        self.options[key] = value\n\n    # option setting needed\n    def __getitem__(self, key):\n        return self.options.get(key, '')\n\n    def __init__(self):\n        # strategy property\n        self.subscribed_books = {\n            'Bitfinex': {\n                'pairs': ['ETH-USDT'],\n            },\n        }\n        self.period = 10 * 60\n        self.options = {}\n\n        # user defined class attribute\n        self.last_type = 'sell'\n        self.last_cross_status = None\n        self.close_price_trace = np.array([])\n        self.ma_long = 10\n        self.ma_short = 5\n        self.UP = 1\n        self.DOWN = 2\n\n    def on_order_state_change(self,  order):\n        CA.log(\"on order state change message: \" + str(order) + \" order price: \" + str(order[\"price\"]))\n\n    def get_current_ma_cross(self):\n        s_ma = talib.SMA(self.close_price_trace, self.ma_short)[-1]\n        l_ma = talib.SMA(self.close_price_trace, self.ma_long)[-1]\n        if np.isnan(s_ma) or np.isnan(l_ma):\n            return None\n        if s_ma > l_ma:\n            return self.UP\n        return self.DOWN\n\n\n    # called every self.period\n    def trade(self, information):\n        exchange = list(information['candles'])[0]\n        pair = list(information['candles'][exchange])[0]\n        target_currency = pair.split('-')[0]  #ETH\n        base_currency = pair.split('-')[1]  #USDT\n        base_currency_amount = self['assets'][exchange][base_currency]\n        target_currency_amount = self['assets'][exchange][target_currency]\n        # add latest price into trace\n        close_price = information['candles'][exchange][pair][0]['close']\n        self.close_price_trace = np.append(self.close_price_trace, [float(close_price)])\n        # only keep max length of ma_long count elements\n        self.close_price_trace = self.close_price_trace[-self.ma_long:]\n        # calculate current ma cross status\n        cur_cross = self.get_current_ma_cross()\n        if cur_cross is None:\n            return []\n        if self.last_cross_status is None:\n            self.last_cross_status = cur_cross\n            return []\n        # cross up\n        if self.last_type == 'sell' and cur_cross == self.UP and self.last_cross_status == self.DOWN:\n            CA.log('buying 1 unit of ' + str(target_currency))\n            self.last_type = 'buy'\n            self.last_cross_status = cur_cross\n            return [\n                {\n                    'exchange': exchange,\n                    'amount': 1,\n                    'price': -1,\n                    'type': 'MARKET',\n                    'pair': pair,\n                }\n            ]\n        # cross down\n        elif self.last_type == 'buy' and cur_cross == self.DOWN and self.last_cross_status == self.UP:\n            CA.log('assets before selling: ' + str(self['assets'][exchange][base_currency]))\n            self.last_type = 'sell'\n            self.last_cross_status = cur_cross\n            return [\n                {\n                    'exchange': exchange,\n                    'amount': -target_currency_amount,\n                    'price': -1,\n                    'type': 'MARKET',\n                    'pair': pair,\n                }\n            ]\n        self.last_cross_status = cur_cross\n        return []\n\n")),(0,i.kt)("h2",{id:"binary-code"},"Binary Code"),(0,i.kt)("p",null,"\u4f7f\u7528 python \u958b\u767c\u6642\uff0c\u53ef\u4ee5\u9078\u64c7\u4e0a\u50b3 binary code \u4fdd\u8b77\u539f\u59cb\u78bc\n\u8acb\u52d9\u5fc5\u4f7f\u7528 python 3.6 \u7248\u672c\u9032\u884c\u7de8\u8b6f"),(0,i.kt)("ol",null,(0,i.kt)("li",{parentName:"ol"},"\u8acb\u5148\u4ee5 ",(0,i.kt)("inlineCode",{parentName:"li"},"python3 -m py_compile strategy.py")," \u5c07\u539f\u59cb\u78bc\u7de8\u8b6f"),(0,i.kt)("li",{parentName:"ol"},"\u81f3 ",(0,i.kt)("inlineCode",{parentName:"li"},"./__pycache__ ")," \u4e2d\u627e\u5230 ",(0,i.kt)("inlineCode",{parentName:"li"},"strategy.cpython-36.pyc")),(0,i.kt)("li",{parentName:"ol"},"\u5230 My Strategy \u7684 Edit Strategy \u9801\u9762\u9078\u64c7 Use Binary Code \u5f8c\u4e0a\u50b3\u3002")))}c.isMDXComponent=!0}}]);